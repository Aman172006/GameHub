<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Events - GameHub</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link rel="stylesheet" href="../../assets/css/events.css">
    <link rel="stylesheet" href="../../assets/css/components.css">
    
    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand" onclick="goHome()">
                <i class="fas fa-gamepad brand-icon"></i>
                <span class="brand-text">GAMEHUB</span>
            </div>
            <div class="nav-menu">
                <a href="../../index.html" class="nav-link">Home</a>
                <a href="../player/browse-events.html" class="nav-link">Browse Events</a>
                <a href="event-search.html" class="nav-link active">Search Events</a>
                <a href="event-details.html" class="nav-link">Event Details</a>
            </div>
            <div class="nav-buttons" id="nav-buttons">
                <button class="btn-secondary" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i>
                    Back
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="search-main">
        <!-- Search Header -->
        <section class="search-header">
            <div class="search-header-content">
                <h1 class="search-title">
                    <i class="fas fa-search"></i>
                    Advanced Event Search
                </h1>
                <p class="search-subtitle">Find the perfect gaming tournaments and events that match your style</p>
            </div>
        </section>

        <!-- Search Container -->
        <div class="search-container">
            <!-- Advanced Search Form -->
            <section class="search-form-section">
                <div class="search-form-card">
                    <div class="form-header">
                        <h2>
                            <i class="fas fa-filter"></i>
                            Find Your Perfect Tournament
                        </h2>
                        <button class="btn-outline btn-small" onclick="resetSearchForm()">
                            <i class="fas fa-undo"></i>
                            Reset
                        </button>
                    </div>

                    <form id="advanced-search-form" class="advanced-search-form">
                        <!-- Primary Search -->
                        <div class="search-row primary-search">
                            <div class="search-input-container large">
                                <input 
                                    type="text" 
                                    id="main-search" 
                                    name="query"
                                    class="search-input-main" 
                                    placeholder="Search events by name, description, or location..."
                                    autocomplete="off"
                                >
                                <button type="submit" class="search-button-main">
                                    <i class="fas fa-search"></i>
                                    <span>Search</span>
                                </button>
                            </div>
                        </div>

                        <!-- Advanced Filters -->
                        <div class="search-filters-grid">
                            <!-- Category Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-tags"></i>
                                    Game Category
                                </label>
                                <select name="category" class="filter-select">
                                    <option value="">All Categories</option>
                                    <option value="FPS">üî´ First Person Shooter</option>
                                    <option value="MOBA">‚öîÔ∏è MOBA (Multiplayer Online Battle Arena)</option>
                                    <option value="Battle Royale">üèÜ Battle Royale</option>
                                    <option value="Sports">‚öΩ Sports & Racing</option>
                                    <option value="Strategy">üè∞ Real-Time Strategy</option>
                                    <option value="Fighting">üëä Fighting Games</option>
                                    <option value="RPG">üêâ Role-Playing Games</option>
                                    <option value="Simulation">üöÄ Simulation Games</option>
                                    <option value="Puzzle">üß© Puzzle & Casual</option>
                                    <option value="Other">üéÆ Other Games</option>
                                </select>
                            </div>

                            <!-- Location Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Location
                                </label>
                                <div class="location-input-container">
                                    <input 
                                        type="text" 
                                        name="location" 
                                        class="filter-input" 
                                        placeholder="City, state, or online"
                                        list="location-suggestions"
                                    >
                                    <datalist id="location-suggestions">
                                        <option value="Online">
                                        <option value="New York, NY">
                                        <option value="Los Angeles, CA">
                                        <option value="Chicago, IL">
                                        <option value="Houston, TX">
                                        <option value="London, UK">
                                        <option value="Mumbai, India">
                                        <option value="Toronto, Canada">
                                    </datalist>
                                </div>
                            </div>

                            <!-- Date Range Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-calendar"></i>
                                    Date Range
                                </label>
                                <select name="date_range" class="filter-select">
                                    <option value="">Any Time</option>
                                    <option value="today">Today</option>
                                    <option value="tomorrow">Tomorrow</option>
                                    <option value="this_week">This Week</option>
                                    <option value="next_week">Next Week</option>
                                    <option value="this_month">This Month</option>
                                    <option value="custom">Custom Range</option>
                                </select>
                            </div>

                            <!-- Custom Date Range -->
                            <div class="filter-group date-range-custom" style="display: none;">
                                <label class="filter-label">
                                    <i class="fas fa-calendar-alt"></i>
                                    Custom Date Range
                                </label>
                                <div class="date-range-inputs">
                                    <input type="date" name="start_date" class="filter-input">
                                    <span class="date-separator">to</span>
                                    <input type="date" name="end_date" class="filter-input">
                                </div>
                            </div>

                            <!-- Entry Fee Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-dollar-sign"></i>
                                    Entry Fee
                                </label>
                                <select name="entry_fee" class="filter-select">
                                    <option value="">Any Price</option>
                                    <option value="free">Free Events</option>
                                    <option value="paid">Paid Events</option>
                                    <option value="0-10">$0 - $10</option>
                                    <option value="10-25">$10 - $25</option>
                                    <option value="25-50">$25 - $50</option>
                                    <option value="50-100">$50 - $100</option>
                                    <option value="100+">$100+</option>
                                </select>
                            </div>

                            <!-- Participants Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-users"></i>
                                    Tournament Size
                                </label>
                                <select name="tournament_size" class="filter-select">
                                    <option value="">Any Size</option>
                                    <option value="small">Small (2-16 players)</option>
                                    <option value="medium">Medium (17-64 players)</option>
                                    <option value="large">Large (65-256 players)</option>
                                    <option value="massive">Massive (257+ players)</option>
                                </select>
                            </div>

                            <!-- Skill Level Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-chart-line"></i>
                                    Skill Level
                                </label>
                                <select name="skill_level" class="filter-select">
                                    <option value="">All Levels</option>
                                    <option value="beginner">üü¢ Beginner Friendly</option>
                                    <option value="intermediate">üü° Intermediate</option>
                                    <option value="advanced">üü† Advanced</option>
                                    <option value="professional">‚ö´ Professional Only</option>
                                </select>
                            </div>

                            <!-- Event Type Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-trophy"></i>
                                    Event Type
                                </label>
                                <select name="event_type" class="filter-select">
                                    <option value="">All Types</option>
                                    <option value="tournament">üèÜ Tournament</option>
                                    <option value="league">üìä League</option>
                                    <option value="casual">üéÆ Casual Match</option>
                                    <option value="championship">üëë Championship</option>
                                    <option value="practice">üìö Practice Session</option>
                                </select>
                            </div>

                            <!-- Platform Filter -->
                            <div class="filter-group">
                                <label class="filter-label">
                                    <i class="fas fa-gamepad"></i>
                                    Gaming Platform
                                </label>
                                <select name="platform" class="filter-select">
                                    <option value="">All Platforms</option>
                                    <option value="pc">üñ•Ô∏è PC</option>
                                    <option value="playstation">üéÆ PlayStation</option>
                                    <option value="xbox">üéØ Xbox</option>
                                    <option value="nintendo">üïπÔ∏è Nintendo</option>
                                    <option value="mobile">üì± Mobile</option>
                                    <option value="cross_platform">üåê Cross-Platform</option>
                                </select>
                            </div>
                        </div>

                        <!-- Search Actions -->
                        <div class="search-actions">
                            <div class="search-options">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="available_only" checked>
                                    <div class="checkbox-custom"></div>
                                    <span>Available events only</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="verified_organizers">
                                    <div class="checkbox-custom"></div>
                                    <span>Verified organizers only</span>
                                </label>
                            </div>
                            
                            <div class="action-buttons">
                                <button type="button" class="btn-outline" onclick="saveCurrentSearch()">
                                    <i class="fas fa-bookmark"></i>
                                    Save Search
                                </button>
                                <button type="submit" class="btn-primary btn-large">
                                    <i class="fas fa-search"></i>
                                    Find Events
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Search Results Section -->
            <section class="search-results-section" id="search-results-section" style="display: none;">
                <div class="results-header">
                    <div class="results-info">
                        <h2 id="results-title">Search Results</h2>
                        <p id="results-subtitle">Found 0 events matching your criteria</p>
                    </div>
                    
                    <div class="results-controls">
                        <div class="sort-controls">
                            <label>Sort by:</label>
                            <select id="sort-select" class="sort-select" onchange="applySorting()">
                                <option value="date_asc">Date (Earliest First)</option>
                                <option value="date_desc">Date (Latest First)</option>
                                <option value="relevance">Most Relevant</option>
                                <option value="participants_desc">Most Participants</option>
                                <option value="participants_asc">Fewest Participants</option>
                                <option value="fee_asc">Lowest Entry Fee</option>
                                <option value="fee_desc">Highest Prize Pool</option>
                            </select>
                        </div>
                        
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="grid" onclick="switchResultsView('grid')">
                                <i class="fas fa-th"></i>
                            </button>
                            <button class="view-btn" data-view="list" onclick="switchResultsView('list')">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Search Results Container -->
                <div class="search-results" id="search-results">
                    <!-- Results will be populated here -->
                </div>

                <!-- Load More Results -->
                <div class="load-more-container" id="load-more-container" style="display: none;">
                    <button class="btn-outline" id="load-more-btn" onclick="loadMoreResults()">
                        <i class="fas fa-plus"></i>
                        Load More Results
                    </button>
                </div>
            </section>

            <!-- Saved Searches Section -->
            <section class="saved-searches-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-bookmark"></i>
                        Saved Searches
                    </h3>
                    <button class="btn-outline btn-small" onclick="showAllSavedSearches()">
                        <i class="fas fa-eye"></i>
                        View All
                    </button>
                </div>
                
                <div class="saved-searches-list" id="saved-searches-list">
                    <!-- Saved searches will be populated here -->
                </div>
            </section>

            <!-- Popular Searches Section -->
            <section class="popular-searches-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-fire"></i>
                        Trending Searches
                    </h3>
                </div>
                
                <div class="popular-searches-tags">
                    <button class="search-tag" onclick="quickSearch('FPS tournament')">
                        <i class="fas fa-crosshairs"></i>
                        FPS Tournaments
                    </button>
                    <button class="search-tag" onclick="quickSearch('MOBA championship')">
                        <i class="fas fa-crown"></i>
                        MOBA Championships
                    </button>
                    <button class="search-tag" onclick="quickSearch('free events')">
                        <i class="fas fa-gift"></i>
                        Free Events
                    </button>
                    <button class="search-tag" onclick="quickSearch('online tournament')">
                        <i class="fas fa-globe"></i>
                        Online Tournaments
                    </button>
                    <button class="search-tag" onclick="quickSearch('beginner friendly')">
                        <i class="fas fa-seedling"></i>
                        Beginner Friendly
                    </button>
                    <button class="search-tag" onclick="quickSearch('this weekend')">
                        <i class="fas fa-calendar-weekend"></i>
                        This Weekend
                    </button>
                    <button class="search-tag" onclick="quickSearch('battle royale')">
                        <i class="fas fa-crosshairs"></i>
                        Battle Royale
                    </button>
                    <button class="search-tag" onclick="quickSearch('high prize pool')">
                        <i class="fas fa-money-bill-wave"></i>
                        High Prize Pool
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Save Search Modal -->
    <div id="save-search-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-bookmark"></i> Save Search</h3>
                <span class="modal-close" onclick="closeModal('save-search-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="save-search-form">
                    <div class="form-group">
                        <label class="form-label">Search Name</label>
                        <input type="text" id="search-name" class="form-input" placeholder="Enter a name for this search...">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Current Search Criteria</label>
                        <div class="search-criteria-preview" id="search-criteria-preview">
                            <!-- Criteria will be populated here -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="notify-new-results">
                            <div class="checkbox-custom"></div>
                            <span>Notify me when new events match this search</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('save-search-modal')">Cancel</button>
                <button class="btn-primary" onclick="confirmSaveSearch()">
                    <i class="fas fa-save"></i>
                    Save Search
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../config/api-config.js"></script>
    <script src="../../assets/js/api.js"></script>
    <script src="../../assets/js/auth.js"></script>
    <script src="../../assets/js/utils.js"></script>
    <script src="../../assets/js/events.js"></script>
    
    <script>
        let currentSearchResults = [];
        let currentPage = 1;
        let hasMoreResults = false;
        let currentResultsView = 'grid';
        let searchHistory = JSON.parse(localStorage.getItem('searchHistory') || '[]');
        let savedSearches = JSON.parse(localStorage.getItem('savedSearches') || '[]');

        // Initialize search page
        document.addEventListener('DOMContentLoaded', function() {
            setupSearchForm();
            loadSavedSearches();
            updateNavigationForAuth();
            
            // Check if there's a search query from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('q')) {
                document.getElementById('main-search').value = urlParams.get('q');
                performSearch();
            }
        });

        // Setup search form
        function setupSearchForm() {
            const form = document.getElementById('advanced-search-form');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                performSearch();
            });

            // Setup date range toggle
            const dateRangeSelect = document.querySelector('select[name="date_range"]');
            const customDateRange = document.querySelector('.date-range-custom');
            
            dateRangeSelect.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customDateRange.style.display = 'block';
                } else {
                    customDateRange.style.display = 'none';
                }
            });

            // Setup live search suggestions
            const mainSearchInput = document.getElementById('main-search');
            mainSearchInput.addEventListener('input', debounceFunction(showSearchSuggestions, 300));
        }

        // Perform search
        async function performSearch() {
            const formData = new FormData(document.getElementById('advanced-search-form'));
            const searchParams = {};
            
            // Convert FormData to object
            for (let [key, value] of formData.entries()) {
                if (value) searchParams[key] = value;
            }
            
            try {
                showSearchLoading();
                
                // Add to search history
                addToSearchHistory(searchParams);
                
                // Perform API search
                const results = await api.searchEvents(searchParams);
                
                currentSearchResults = results.events || [];
                hasMoreResults = results.hasMore || false;
                currentPage = 1;
                
                displaySearchResults(currentSearchResults);
                updateResultsInfo(results.total || 0, searchParams);
                
                // Show results section
                document.getElementById('search-results-section').style.display = 'block';
                
            } catch (error) {
                console.error('Search error:', error);
                showSearchError();
            }
        }

        // Display search results
        function displaySearchResults(results) {
            const resultsContainer = document.getElementById('search-results');
            
            if (results.length === 0) {
                showNoResults();
                return;
            }
            
            if (currentResultsView === 'grid') {
                displayResultsGrid(results);
            } else {
                displayResultsList(results);
            }
            
            updateLoadMoreVisibility();
        }

        // Display results in grid view
        function displayResultsGrid(results) {
            const resultsContainer = document.getElementById('search-results');
            
            resultsContainer.innerHTML = `
                <div class="search-results-grid">
                    ${results.map(event => createSearchResultCard(event)).join('')}
                </div>
            `;
        }

        // Display results in list view
        function displayResultsList(results) {
            const resultsContainer = document.getElementById('search-results');
            
            resultsContainer.innerHTML = `
                <div class="search-results-list">
                    ${results.map(event => createSearchResultListItem(event)).join('')}
                </div>
            `;
        }

        // Create search result card
        function createSearchResultCard(event) {
            const registrationProgress = Math.round(((event.registered_count || 0) / event.max_participants) * 100);
            const isEventFull = registrationProgress >= 100;
            const daysUntil = Math.ceil((new Date(event.date) - new Date()) / (1000 * 60 * 60 * 24));
            
            return `
                <div class="search-result-card" data-event-id="${event.id}">
                    <div class="result-card-header">
                        <span class="event-category">${event.category}</span>
                        <div class="event-badges">
                            ${event.verified_organizer ? '<span class="verified-badge"><i class="fas fa-check-circle"></i></span>' : ''}
                            ${!event.entry_fee ? '<span class="free-badge">FREE</span>' : ''}
                            ${isEventFull ? '<span class="full-badge">FULL</span>' : ''}
                        </div>
                    </div>
                    
                    <div class="result-card-content">
                        <h3 class="event-title">${event.title}</h3>
                        <p class="event-description">${StringUtils.truncate(event.description, 120)}</p>
                        
                        <div class="event-details">
                            <div class="detail-item">
                                <i class="fas fa-calendar"></i>
                                <span>${DateUtils.formatDate(event.date)} at ${event.time}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${event.location}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-users"></i>
                                <span>${event.registered_count || 0}/${event.max_participants} players</span>
                            </div>
                            ${event.entry_fee ? `
                                <div class="detail-item">
                                    <i class="fas fa-dollar-sign"></i>
                                    <span>$${event.entry_fee} entry</span>
                                </div>
                            ` : ''}
                            ${event.prize_pool ? `
                                <div class="detail-item prize">
                                    <i class="fas fa-trophy"></i>
                                    <span>$${event.prize_pool} prize pool</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="event-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${registrationProgress}%"></div>
                            </div>
                            <span class="progress-text">${registrationProgress}% full</span>
                        </div>
                        
                        ${daysUntil <= 7 && daysUntil > 0 ? `
                            <div class="urgency-indicator">
                                <i class="fas fa-clock"></i>
                                <span>${daysUntil} day${daysUntil !== 1 ? 's' : ''} left to register!</span>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="result-card-actions">
                        <button class="btn-outline btn-small" onclick="viewEventDetails(${event.id})">
                            <i class="fas fa-eye"></i>
                            View Details
                        </button>
                        <button class="btn-primary btn-small" onclick="registerForEvent(${event.id})" ${isEventFull ? 'disabled' : ''}>
                            <i class="fas fa-plus"></i>
                            ${isEventFull ? 'Event Full' : 'Register'}
                        </button>
                    </div>
                </div>
            `;
        }

        // Create search result list item
        function createSearchResultListItem(event) {
            const registrationProgress = Math.round(((event.registered_count || 0) / event.max_participants) * 100);
            const isEventFull = registrationProgress >= 100;
            
            return `
                <div class="search-result-list-item" data-event-id="${event.id}">
                    <div class="result-list-content">
                        <div class="result-primary">
                            <div class="event-title-section">
                                <h3 class="event-title">${event.title}</h3>
                                <div class="event-badges-inline">
                                    <span class="category-badge">${event.category}</span>
                                    ${!event.entry_fee ? '<span class="free-badge">FREE</span>' : ''}
                                    ${event.verified_organizer ? '<span class="verified-badge"><i class="fas fa-check-circle"></i> Verified</span>' : ''}
                                </div>
                            </div>
                            <p class="event-description">${StringUtils.truncate(event.description, 150)}</p>
                        </div>
                        
                        <div class="result-details">
                            <div class="detail-columns">
                                <div class="detail-column">
                                    <div class="detail-item">
                                        <i class="fas fa-calendar"></i>
                                        <span>${DateUtils.formatDate(event.date)}</span>
                                    </div>
                                    <div class="detail-item">
                                        <i class="fas fa-clock"></i>
                                        <span>${event.time}</span>
                                    </div>
                                </div>
                                <div class="detail-column">
                                    <div class="detail-item">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>${event.location}</span>
                                    </div>
                                    <div class="detail-item">
                                        <i class="fas fa-users"></i>
                                        <span>${event.registered_count || 0}/${event.max_participants}</span>
                                    </div>
                                </div>
                                <div class="detail-column">
                                    ${event.entry_fee ? `
                                        <div class="detail-item">
                                            <i class="fas fa-dollar-sign"></i>
                                            <span>$${event.entry_fee}</span>
                                        </div>
                                    ` : ''}
                                    ${event.prize_pool ? `
                                        <div class="detail-item prize">
                                            <i class="fas fa-trophy"></i>
                                            <span>$${event.prize_pool}</span>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-list-actions">
                        <div class="progress-info">
                            <div class="progress-bar small">
                                <div class="progress-fill" style="width: ${registrationProgress}%"></div>
                            </div>
                            <span class="progress-text">${registrationProgress}%</span>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-outline btn-small" onclick="viewEventDetails(${event.id})">
                                <i class="fas fa-eye"></i>
                                Details
                            </button>
                            <button class="btn-primary btn-small" onclick="registerForEvent(${event.id})" ${isEventFull ? 'disabled' : ''}>
                                <i class="fas fa-plus"></i>
                                ${isEventFull ? 'Full' : 'Register'}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Switch results view
        function switchResultsView(view) {
            currentResultsView = view;
            
            // Update buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-view="${view}"]`).classList.add('active');
            
            // Redisplay results
            displaySearchResults(currentSearchResults);
        }

        // Apply sorting
        function applySorting() {
            const sortValue = document.getElementById('sort-select').value;
            
            const sortedResults = [...currentSearchResults].sort((a, b) => {
                switch (sortValue) {
                    case 'date_asc':
                        return new Date(a.date) - new Date(b.date);
                    case 'date_desc':
                        return new Date(b.date) - new Date(a.date);
                    case 'participants_desc':
                        return (b.registered_count || 0) - (a.registered_count || 0);
                    case 'participants_asc':
                        return (a.registered_count || 0) - (b.registered_count || 0);
                    case 'fee_asc':
                        return (a.entry_fee || 0) - (b.entry_fee || 0);
                    case 'fee_desc':
                        return (b.prize_pool || 0) - (a.prize_pool || 0);
                    default:
                        return 0; // relevance - keep original order
                }
            });
            
            displaySearchResults(sortedResults);
        }

        // Load more results
        async function loadMoreResults() {
            try {
                const loadMoreBtn = document.getElementById('load-more-btn');
                const originalText = loadMoreBtn.innerHTML;
                
                loadMoreBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
                loadMoreBtn.disabled = true;
                
                currentPage++;
                const formData = new FormData(document.getElementById('advanced-search-form'));
                const searchParams = {};
                
                for (let [key, value] of formData.entries()) {
                    if (value) searchParams[key] = value;
                }
                searchParams.page = currentPage;
                
                const results = await api.searchEvents(searchParams);
                const newEvents = results.events || [];
                
                currentSearchResults = [...currentSearchResults, ...newEvents];
                hasMoreResults = results.hasMore || false;
                
                // Append new results
                const resultsContainer = currentResultsView === 'grid' ? 
                    document.querySelector('.search-results-grid') : 
                    document.querySelector('.search-results-list');
                
                if (resultsContainer) {
                    const newResultsHTML = newEvents.map(event => 
                        currentResultsView === 'grid' ? 
                        createSearchResultCard(event) : 
                        createSearchResultListItem(event)
                    ).join('');
                    
                    resultsContainer.insertAdjacentHTML('beforeend', newResultsHTML);
                }
                
                updateLoadMoreVisibility();
                
            } catch (error) {
                console.error('Load more error:', error);
                showNotification('Failed to load more results', 'error');
            } finally {
                const loadMoreBtn = document.getElementById('load-more-btn');
                loadMoreBtn.innerHTML = '<i class="fas fa-plus"></i> Load More Results';
                loadMoreBtn.disabled = false;
            }
        }

        // Quick search function
        function quickSearch(query) {
            document.getElementById('main-search').value = query;
            resetSearchForm(false); // Don't reset main search
            performSearch();
            
            // Scroll to results
            setTimeout(() => {
                document.getElementById('search-results-section').scrollIntoView({ 
                    behavior: 'smooth' 
                });
            }, 500);
        }

        // Reset search form
        function resetSearchForm(includeMainSearch = true) {
            const form = document.getElementById('advanced-search-form');
            
            if (includeMainSearch) {
                form.reset();
            } else {
                // Reset all except main search
                const mainSearchValue = document.getElementById('main-search').value;
                form.reset();
                document.getElementById('main-search').value = mainSearchValue;
            }
            
            // Hide custom date range
            document.querySelector('.date-range-custom').style.display = 'none';
            
            // Hide results section
            document.getElementById('search-results-section').style.display = 'none';
        }

        // Save search functionality
        function saveCurrentSearch() {
            const formData = new FormData(document.getElementById('advanced-search-form'));
            const searchParams = {};
            
            for (let [key, value] of formData.entries()) {
                if (value) searchParams[key] = value;
            }
            
            if (Object.keys(searchParams).length === 0) {
                showNotification('Please enter search criteria first', 'warning');
                return;
            }
            
            // Show search criteria preview
            displaySearchCriteria(searchParams);
            
            // Open save modal
            openModal('save-search-modal');
        }

        function displaySearchCriteria(params) {
            const preview = document.getElementById('search-criteria-preview');
            const criteriaItems = [];
            
            Object.entries(params).forEach(([key, value]) => {
                const label = formatSearchCriteriaLabel(key, value);
                if (label) {
                    criteriaItems.push(`<span class="criteria-item">${label}</span>`);
                }
            });
            
            preview.innerHTML = criteriaItems.join('');
        }

        function formatSearchCriteriaLabel(key, value) {
            const labels = {
                query: `Search: "${value}"`,
                category: `Category: ${value}`,
                location: `Location: ${value}`,
                date_range: `Date: ${value}`,
                entry_fee: `Fee: ${value}`,
                tournament_size: `Size: ${value}`,
                skill_level: `Skill: ${value}`,
                event_type: `Type: ${value}`,
                platform: `Platform: ${value}`
            };
            
            return labels[key] || null;
        }

        async function confirmSaveSearch() {
            const name = document.getElementById('search-name').value.trim();
            const notify = document.getElementById('notify-new-results').checked;
            
            if (!name) {
                showNotification('Please enter a name for this search', 'warning');
                return;
            }
            
            const formData = new FormData(document.getElementById('advanced-search-form'));
            const searchParams = {};
            
            for (let [key, value] of formData.entries()) {
                if (value) searchParams[key] = value;
            }
            
            const savedSearch = {
                id: Date.now(),
                name: name,
                params: searchParams,
                notify: notify,
                created: new Date().toISOString(),
                lastUsed: new Date().toISOString()
            };
            
            savedSearches.push(savedSearch);
            localStorage.setItem('savedSearches', JSON.stringify(savedSearches));
            
            showNotification('Search saved successfully!', 'success');
            closeModal('save-search-modal');
            
            // Clear the form
            document.getElementById('search-name').value = '';
            document.getElementById('notify-new-results').checked = false;
            
            // Refresh saved searches display
            loadSavedSearches();
        }

        // Search history and saved searches
        function addToSearchHistory(params) {
            const historyItem = {
                params: params,
                timestamp: new Date().toISOString(),
                id: Date.now()
            };
            
            searchHistory.unshift(historyItem);
            searchHistory = searchHistory.slice(0, 10); // Keep only 10 recent searches
            
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
        }

        function loadSavedSearches() {
            const container = document.getElementById('saved-searches-list');
            
            if (savedSearches.length === 0) {
                container.innerHTML = `
                    <div class="empty-saved-searches">
                        <i class="fas fa-bookmark"></i>
                        <p>No saved searches yet. Save your frequent searches for quick access!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = savedSearches.slice(0, 3).map(search => `
                <div class="saved-search-item">
                    <div class="saved-search-info">
                        <h4 class="saved-search-name">${search.name}</h4>
                        <p class="saved-search-details">${formatSearchSummary(search.params)}</p>
                        <span class="saved-search-date">Saved ${DateUtils.getTimeAgo(search.created)}</span>
                    </div>
                    <div class="saved-search-actions">
                        <button class="btn-outline btn-small" onclick="loadSavedSearch(${search.id})">
                            <i class="fas fa-play"></i>
                            Run
                        </button>
                        <button class="btn-secondary btn-small" onclick="deleteSavedSearch(${search.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function formatSearchSummary(params) {
            const parts = [];
            if (params.query) parts.push(`"${params.query}"`);
            if (params.category) parts.push(params.category);
            if (params.location) parts.push(params.location);
            if (params.date_range) parts.push(params.date_range);
            
            return parts.slice(0, 3).join(' ‚Ä¢ ') + (parts.length > 3 ? '...' : '');
        }

        function loadSavedSearch(searchId) {
            const search = savedSearches.find(s => s.id === searchId);
            if (!search) return;
            
            // Update form with saved parameters
            const form = document.getElementById('advanced-search-form');
            Object.entries(search.params).forEach(([key, value]) => {
                const field = form.querySelector(`[name="${key}"]`);
                if (field) {
                    if (field.type === 'checkbox') {
                        field.checked = value === 'on' || value === true;
                    } else {
                        field.value = value;
                    }
                }
            });
            
            // Update last used timestamp
            search.lastUsed = new Date().toISOString();
            localStorage.setItem('savedSearches', JSON.stringify(savedSearches));
            
            // Perform search
            performSearch();
        }

        function deleteSavedSearch(searchId) {
            if (confirm('Are you sure you want to delete this saved search?')) {
                savedSearches = savedSearches.filter(s => s.id !== searchId);
                localStorage.setItem('savedSearches', JSON.stringify(savedSearches));
                loadSavedSearches();
                showNotification('Saved search deleted', 'success');
            }
        }

        // Navigation and utility functions
        function updateNavigationForAuth() {
            const navButtons = document.getElementById('nav-buttons');
            const currentUser = auth.getCurrentUser();
            
            if (currentUser) {
                navButtons.innerHTML += `
                    <div class="user-menu-mini">
                        <span class="user-name">${currentUser.name}</span>
                        <a href="../${currentUser.role}/dashboard.html" class="btn-primary">
                            <i class="fas fa-tachometer-alt"></i>
                            Dashboard
                        </a>
                    </div>
                `;
            } else {
                navButtons.innerHTML += `
                    <button class="btn-primary" onclick="redirectToLogin()">
                        <i class="fas fa-sign-in-alt"></i>
                        Login
                    </button>
                `;
            }
        }

        function viewEventDetails(eventId) {
            localStorage.setItem('selectedEventId', eventId);
            window.location.href = 'event-details.html';
        }

        async function registerForEvent(eventId) {
            if (!auth.isAuthenticated()) {
                redirectToLogin();
                return;
            }
            
            try {
                await api.registerForEvent(eventId);
                showNotification('Successfully registered for the event!', 'success');
                
                // Refresh the specific event card to show updated registration
                // You could implement this to update just that card
                
            } catch (error) {
                console.error('Registration error:', error);
                showNotification('Failed to register for event. Please try again.', 'error');
            }
        }

        function redirectToLogin() {
            localStorage.setItem('redirectAfterLogin', window.location.href);
            window.location.href = '../auth/login.html';
        }

        function goHome() {
            window.location.href = '../../index.html';
        }

        function goBack() {
            if (document.referrer) {
                window.history.back();
            } else {
                window.location.href = '../player/browse-events.html';
            }
        }

        // Utility functions
        function updateResultsInfo(total, searchParams) {
            document.getElementById('results-title').textContent = `Search Results (${total})`;
            
            const queryText = searchParams.query ? ` for "${searchParams.query}"` : '';
            document.getElementById('results-subtitle').textContent = `Found ${total} events${queryText}`;
        }

        function updateLoadMoreVisibility() {
            const container = document.getElementById('load-more-container');
            container.style.display = hasMoreResults ? 'block' : 'none';
        }

        function showSearchLoading() {
            const resultsContainer = document.getElementById('search-results');
            resultsContainer.innerHTML = `
                <div class="search-loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Searching for events...</p>
                </div>
            `;
            document.getElementById('search-results-section').style.display = 'block';
        }

        function showNoResults() {
            const resultsContainer = document.getElementById('search-results');
            resultsContainer.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search"></i>
                    <h3>No Events Found</h3>
                    <p>We couldn't find any events matching your search criteria.</p>
                    <div class="no-results-suggestions">
                        <h4>Try:</h4>
                        <ul>
                            <li>Removing some filters</li>
                            <li>Using different keywords</li>
                            <li>Expanding your date range</li>
                            <li>Including more locations</li>
                        </ul>
                    </div>
                    <button class="btn-primary" onclick="resetSearchForm()">
                        <i class="fas fa-undo"></i>
                        Clear All Filters
                    </button>
                </div>
            `;
        }

        function showSearchError() {
            const resultsContainer = document.getElementById('search-results');
            resultsContainer.innerHTML = `
                <div class="search-error">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>Search Error</h3>
                    <p>There was a problem performing your search. Please try again.</p>
                    <button class="btn-primary" onclick="performSearch()">
                        <i class="fas fa-retry"></i>
                        Try Again
                    </button>
                </div>
            `;
        }

        function showAllSavedSearches() {
            // Implement a full saved searches view
            showNotification('Full saved searches view coming soon!', 'info');
        }

        function showSearchSuggestions(query) {
            // Implement live search suggestions
            // This would show a dropdown with suggested searches
        }

        // Debounce function
        function debounceFunction(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Modal functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('show');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 300);
                document.body.style.overflow = 'auto';
            }
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            const icon = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            }[type];
            
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="${icon}"></i>
                    <span>${message}</span>
                </div>
                <button class="notification-close" onclick="closeNotification(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                closeNotification(notification.querySelector('.notification-close'));
            }, 5000);
        }

        function closeNotification(button) {
            const notification = button.closest('.notification');
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }
    </script>

    <style>
        /* Event Search Specific Styles */
        .search-main {
            min-height: 100vh;
            background: var(--gradient-dark);
            padding-top: 70px;
        }

        .search-header {
            background: linear-gradient(135deg, rgba(220, 20, 60, 0.2), rgba(26, 26, 26, 0.9));
            padding: var(--spacing-xl) 0;
            text-align: center;
            border-bottom: 1px solid rgba(220, 20, 60, 0.3);
        }

        .search-header-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }

        .search-title {
            font-family: var(--font-primary);
            font-size: 3rem;
            font-weight: 900;
            color: var(--white);
            margin-bottom: var(--spacing-md);
            text-shadow: 0 0 20px var(--demon-red);
        }

        .search-subtitle {
            font-size: 1.2rem;
            color: var(--light-gray);
            margin: 0;
        }

        .search-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--spacing-xl);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xl);
        }

        /* Search Form */
        .search-form-card {
            background: var(--gradient-dark);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 20px;
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-glow);
        }

        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
        }

        .form-header h2 {
            font-family: var(--font-primary);
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--demon-red);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .primary-search {
            margin-bottom: var(--spacing-xl);
        }

        .search-input-container.large {
            position: relative;
            display: flex;
            max-width: 800px;
            margin: 0 auto;
        }

        .search-input-main {
            flex: 1;
            padding: 20px 24px;
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid rgba(220, 20, 60, 0.3);
            border-radius: 16px 0 0 16px;
            color: var(--white);
            font-size: 1.1rem;
            font-family: var(--font-secondary);
            outline: none;
            transition: all var(--transition-normal);
        }

        .search-input-main:focus {
            border-color: var(--demon-red);
            box-shadow: 0 0 0 4px rgba(220, 20, 60, 0.15);
        }

        .search-input-main::placeholder {
            color: var(--light-gray);
            opacity: 0.8;
        }

        .search-button-main {
            padding: 20px 32px;
            background: var(--gradient-red);
            border: none;
            border-radius: 0 16px 16px 0;
            color: var(--white);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .search-button-main:hover {
            background: linear-gradient(135deg, #ff1744, #dc143c);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 20, 60, 0.4);
        }

        .search-filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .filter-label {
            font-weight: 600;
            color: var(--white);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .filter-label i {
            color: var(--demon-red);
            width: 16px;
        }

        .filter-select,
        .filter-input {
            padding: 14px 16px;
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid rgba(220, 20, 60, 0.2);
            border-radius: 12px;
            color: var(--white);
            font-size: 1rem;
            font-family: var(--font-secondary);
            transition: all var(--transition-normal);
        }

        .filter-select:focus,
        .filter-input:focus {
            outline: none;
            border-color: var(--demon-red);
            background: rgba(26, 26, 26, 1);
            box-shadow: 0 0 0 4px rgba(220, 20, 60, 0.15);
        }

        .filter-select option {
            background: var(--dark-gray);
            color: var(--white);
        }

        .date-range-inputs {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .date-separator {
            color: var(--light-gray);
            font-weight: 600;
        }

        /* Search Actions */
        .search-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }

        .search-options {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--white);
            cursor: pointer;
            font-size: 0.9rem;
            user-select: none;
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid rgba(220, 20, 60, 0.3);
            border-radius: 4px;
            position: relative;
            transition: all var(--transition-normal);
        }

        .checkbox-label input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"]:checked + .checkbox-custom {
            background: var(--demon-red);
            border-color: var(--demon-red);
        }

        .checkbox-label input[type="checkbox"]:checked + .checkbox-custom::after {
            content: '\2713';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--white);
            font-size: 14px;
            font-weight: bold;
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        /* Search Results */
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .results-info h2 {
            font-family: var(--font-primary);
            font-size: 2rem;
            font-weight: 700;
            color: var(--white);
            margin: 0 0 var(--spacing-xs) 0;
        }

        .results-info p {
            color: var(--light-gray);
            margin: 0;
            font-size: 1.1rem;
        }

        .results-controls {
            display: flex;
            gap: var(--spacing-lg);
            align-items: center;
        }

        .sort-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--white);
        }

        .sort-select {
            padding: 8px 12px;
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 8px;
            color: var(--white);
        }

        .view-toggle {
            display: flex;
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }

        .view-btn {
            background: none;
            border: none;
            color: var(--light-gray);
            padding: 10px 14px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .view-btn:hover {
            background: rgba(220, 20, 60, 0.1);
            color: var(--white);
        }

        .view-btn.active {
            background: var(--demon-red);
            color: var(--white);
        }

        /* Search Result Cards */
        .search-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: var(--spacing-xl);
        }

        .search-result-card {
            background: var(--gradient-dark);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 16px;
            overflow: hidden;
            transition: all var(--transition-normal);
            position: relative;
        }

        .search-result-card:hover {
            transform: translateY(-4px);
            border-color: var(--demon-red);
            box-shadow: var(--shadow-glow);
        }

        .result-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            border-bottom: 1px solid rgba(220, 20, 60, 0.2);
        }

        .event-badges {
            display: flex;
            gap: var(--spacing-xs);
        }

        .verified-badge {
            color: #22c55e;
            font-size: 1.2rem;
        }

        .free-badge,
        .full-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .free-badge {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .full-badge {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .result-card-content {
            padding: var(--spacing-lg);
        }

        .result-card-content .event-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--white);
            margin: 0 0 var(--spacing-sm) 0;
            line-height: 1.3;
        }

        .result-card-content .event-description {
            color: var(--light-gray);
            line-height: 1.6;
            margin-bottom: var(--spacing-md);
        }

        .event-details {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            color: var(--light-gray);
            font-size: 0.9rem;
        }

        .detail-item i {
            color: var(--demon-red);
            width: 16px;
            text-align: center;
        }

        .detail-item.prize {
            color: #fbbf24;
            font-weight: 600;
        }

        .detail-item.prize i {
            color: #fbbf24;
        }

        .event-progress {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: rgba(220, 20, 60, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-red);
            transition: width var(--transition-normal);
        }

        .progress-text {
            font-size: 0.8rem;
            color: var(--light-gray);
            font-weight: 600;
            min-width: 60px;
            text-align: right;
        }

        .urgency-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.4);
            border-radius: 8px;
            padding: var(--spacing-xs) var(--spacing-sm);
            color: #f59e0b;
            font-size: 0.8rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        .result-card-actions {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            border-top: 1px solid rgba(220, 20, 60, 0.2);
        }

        .result-card-actions .btn-small {
            flex: 1;
            justify-content: center;
        }

        /* Search Results List View */
        .search-results-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .search-result-list-item {
            background: var(--gradient-dark);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 16px;
            padding: var(--spacing-lg);
            display: flex;
            gap: var(--spacing-lg);
            transition: all var(--transition-normal);
        }

        .search-result-list-item:hover {
            border-color: var(--demon-red);
            box-shadow: var(--shadow-glow);
        }

        .result-list-content {
            flex: 1;
        }

        .result-primary {
            margin-bottom: var(--spacing-md);
        }

        .event-title-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
            gap: var(--spacing-md);
        }

        .event-badges-inline {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
        }

        .category-badge,
        .verified-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .category-badge {
            background: rgba(220, 20, 60, 0.2);
            color: var(--demon-red);
        }

        .detail-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
        }

        .detail-column {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .result-list-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: var(--spacing-md);
            min-width: 200px;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            width: 100%;
        }

        .progress-bar.small {
            height: 6px;
            width: 120px;
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-sm);
        }

        /* Saved Searches */
        .saved-searches-section,
        .popular-searches-section {
            background: var(--gradient-dark);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 16px;
            padding: var(--spacing-lg);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .section-header h3 {
            font-family: var(--font-primary);
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--demon-red);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .saved-search-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md);
            background: rgba(220, 20, 60, 0.05);
            border: 1px solid rgba(220, 20, 60, 0.2);
            border-radius: 12px;
            margin-bottom: var(--spacing-sm);
        }

        .saved-search-info {
            flex: 1;
        }

        .saved-search-name {
            font-weight: 700;
            color: var(--white);
            margin: 0 0 4px 0;
        }

        .saved-search-details {
            color: var(--light-gray);
            font-size: 0.9rem;
            margin: 0 0 4px 0;
        }

        .saved-search-date {
            font-size: 0.8rem;
            color: var(--light-gray);
        }

        .saved-search-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        /* Popular Search Tags */
        .popular-searches-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .search-tag {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(220, 20, 60, 0.1);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 20px;
            color: var(--white);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .search-tag:hover {
            background: rgba(220, 20, 60, 0.2);
            border-color: var(--demon-red);
            color: var(--demon-red);
            transform: translateY(-2px);
        }

        /* State Styles */
        .search-loading,
        .no-results,
        .search-error {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--light-gray);
        }

        .search-loading i,
        .no-results i,
        .search-error i {
            font-size: 3rem;
            color: var(--demon-red);
            margin-bottom: var(--spacing-lg);
        }

        .no-results h3,
        .search-error h3 {
            color: var(--white);
            margin-bottom: var(--spacing-md);
        }

        .no-results-suggestions {
            background: rgba(220, 20, 60, 0.05);
            border-radius: 12px;
            padding: var(--spacing-lg);
            margin: var(--spacing-lg) 0;
            text-align: left;
        }

        .no-results-suggestions h4 {
            color: var(--demon-red);
            margin-bottom: var(--spacing-sm);
        }

        .no-results-suggestions ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .no-results-suggestions li {
            padding: 4px 0;
            color: var(--light-gray);
        }

        .no-results-suggestions li::before {
            content: '‚Ä¢';
            color: var(--demon-red);
            font-weight: bold;
            margin-right: var(--spacing-xs);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .search-filters-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .search-title {
                font-size: 2.2rem;
            }
            
            .search-filters-grid {
                grid-template-columns: 1fr;
            }
            
            .search-actions {
                flex-direction: column;
                align-items: stretch;
            }
            
            .action-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .results-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .results-controls {
                flex-direction: column;
                align-items: stretch;
                gap: var(--spacing-md);
            }
            
            .search-results-grid {
                grid-template-columns: 1fr;
            }
            
            .search-result-list-item {
                flex-direction: column;
            }
            
            .result-list-actions {
                align-items: stretch;
                min-width: auto;
            }
            
            .action-buttons {
                width: 100%;
            }
            
            .popular-searches-tags {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .search-container {
                padding: var(--spacing-lg);
            }
            
            .search-form-card {
                padding: var(--spacing-lg);
            }
            
            .search-input-container.large {
                flex-direction: column;
            }
            
            .search-input-main {
                border-radius: 16px 16px 0 0;
            }
            
            .search-button-main {
                border-radius: 0 0 16px 16px;
                justify-content: center;
            }
            
            .date-range-inputs {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-options {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>

</body>
</html>
